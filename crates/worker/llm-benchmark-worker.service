[Unit]
Description=LLM Benchmark Exchange Worker
After=network.target redis.service postgresql.service
Wants=redis.service postgresql.service

[Service]
Type=simple
User=benchmark
Group=benchmark
WorkingDirectory=/opt/llm-benchmark
Environment="RUST_LOG=info"
Environment="REDIS_URL=redis://localhost:6379"
Environment="DATABASE_URL=postgresql://localhost:5432/llm_benchmark"
Environment="WORKER_POOL_SIZE=4"
Environment="METRICS_INTERVAL=60"
ExecStart=/usr/local/bin/worker --config /etc/llm-benchmark/worker.json
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal
SyslogIdentifier=llm-worker

# Resource limits
LimitNOFILE=65536
LimitNPROC=4096

# Security settings
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/lib/llm-benchmark

[Install]
WantedBy=multi-user.target
