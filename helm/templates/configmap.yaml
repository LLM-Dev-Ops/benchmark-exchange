apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "llm-benchmark-exchange.fullname" . }}-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "llm-benchmark-exchange.labels" . | nindent 4 }}
data:
  # S3 Configuration
  S3_ENDPOINT: {{ .Values.s3.endpoint | quote }}
  S3_REGION: {{ .Values.s3.region | quote }}
  S3_BUCKET: {{ .Values.s3.bucket | quote }}
  S3_PATH_STYLE: {{ .Values.s3.pathStyle | quote }}

  # CORS Configuration
  CORS_ALLOWED_ORIGINS: {{ .Values.secrets.corsAllowedOrigins | quote }}

  # Feature Flags
  FEATURE_GOVERNANCE: {{ .Values.features.governance | quote }}
  FEATURE_REPUTATION: {{ .Values.features.reputation | quote }}
  FEATURE_LEADERBOARD: {{ .Values.features.leaderboard | quote }}

  # Redis URL
  REDIS_URL: {{ include "llm-benchmark-exchange.redisUrl" . | quote }}

  # PostgreSQL host (for service discovery)
  {{- if not .Values.externalDatabase.enabled }}
  POSTGRES_HOST: {{ include "llm-benchmark-exchange.fullname" . }}-postgresql
  POSTGRES_PORT: "5432"
  {{- else }}
  POSTGRES_HOST: {{ .Values.externalDatabase.host | quote }}
  POSTGRES_PORT: {{ .Values.externalDatabase.port | quote }}
  {{- end }}
